pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
#include utils.lua
#include animation.lua

game_state_title   = 'title'
game_state_playing = 'playing'
game_state_won     = 'won'

-- Default state so title screen works
g_anims = {}
frame_count = 0

function _init()
   cam = make_obj({
         x = 0,
         y = 0,
   })
   player = make_obj({
         x = 12,
         y = 26,
         frames = 1,
         sprite = 0,
         speed_x = 0,
         move_dir = 0,
   })
end

function _update60()
   if btn(b_right) then
      player.move_dir = 1
      local sx = player.move_dir * 0.01
      if sx < 4 then
         player.speed_x += sx
      end
   end
   if btn(b_left) then
      player.move_dir = -1
      local sx = player.move_dir * 0.01
      if sx < 4 then
         player.speed_x += sx
      end
   end
   player.speed_x *= 0.991

   cam.x    += player.speed_x
   player.x += player.speed_x
end

function _draw()
   cls(black)
   camera(cam.x, cam.y)
   rectfill(cam.x, cam.y,  cam.x+127, cam.y+31, pink)
   rectfill(cam.x, cam.y+32, cam.x+127, cam.y+127, orange)
   spr(player.sprite, player.x, player.y)
   rectfill(cam.x, cam.y, cam.x+127, cam.y+7, white)
   print(dumper(player.speed_x, ' @ ', player.x), cam.x+1, cam.y+1, slate)
   pal(ember, tea, 1)
   for i = 0,20 do
      spr(16, 8*i, 121)
      spr(16, 8*i, 113)
      spr(16, 8*i, 105)
   end
end

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00aaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0aacaca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0aacaca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a9aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0aa99aa0009009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00aaaa00099999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000996666990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00d80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
008d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
